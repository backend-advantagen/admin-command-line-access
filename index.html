<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>secure terminal access</title>
    <style>

@font-face {
        font-family: 'LionelMicroNbp-gA25';
        src: url('https://static1.squarespace.com/static/61677fb4ed3774477e5e74fb/t/616895c6f2208b3de7fb48e9/1634244038098/VCR_OSD_MONO_1.001.ttf') format('truetype');
    }


        body {
            font-family: 'Courier New', Courier, monospace;
            background-color: black;
            color: lime;
            padding: 20px;
            font-size: 16px;
        }
        
        #output {
            white-space: pre-wrap; 
        }

        #inputLine {
            display: flex;
            align-items: center;
            visibility: hidden; /* Initially hidden */
        }

        #prompt {
            margin-right: 10px;
        }

        #userInput {
            width: 80%;
            color: lime;
            background-color: black;
            border: none;
            outline: none;
            font-family: 'Courier New', Courier, monospace;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <audio id="backgroundAudio" loop preload="auto" style="display:none;">
        <source src="https://cod-gardenia.squarespace.com/s/White-Cyclosa.mp3" type="audio/mp3">
        Your browser does not support the audio element.
    </audio>

    <div id="output"></div>
    <div id="inputLine">
        <span id="prompt">>[USER]:</span>
        <input type="text" id="userInput" autofocus disabled>
    </div>

    <script>


    // Get a reference to the audio element
    const backgroundAudio = document.getElementById('backgroundAudio');


    function backspaceLetterByLetter(element, callback = null, interval = 100) {
    let text = element.innerHTML;
    function removeLetter() {
        if (text.length > 0) {
            text = text.slice(0, -1); // Remove the last character
            element.innerHTML = text;
            setTimeout(removeLetter, interval);
        } else if (callback) {
            callback();
        }
    }
    setTimeout(removeLetter, 5000); // Start after 10 seconds
}

// Modify the startup sequence
function startUpSequence() {
    const stageMessageText = "Stage 5: Whistleblower";
    const stageMessageElement = document.createElement('div');
    stageMessageElement.style.fontFamily = 'LionelMicroNbp-gA25';
    stageMessageElement.style.color = 'white';  // Apply the custom font
    output.appendChild(stageMessageElement); // Append the stage message element to the output

    printLetterByLetter(stageMessageElement, stageMessageText, function() {
        // After the message is printed, start the backspacing after 10 seconds
        backspaceLetterByLetter(stageMessageElement, function() {
            // Remove the stage message element after backspacing is complete
            output.removeChild(stageMessageElement);

            // After the backspacing is done, print the initial messages
            printLetterByLetter(output, '// INITIALIZING SYSTEM PROTOCOLS...\n// WELCOME TO SECURE TERMINAL v4.2.1\n\n************\n\n[SECURE TERMINAL]: Initializing...\n', function() {
                printLetterByLetter(output, '[SECURE TERMINAL]: System ready.\n', function() {
                    // Show the input prompt after the messages
                    inputLine.style.visibility = "visible";
                    userInput.disabled = false;
                    userInput.focus();
                });
            });
        });
    });
}



function simulateForwarding(element, totalBytes) {
    let forwardedBytes = 0;
    const interval = 0.01; // Speed of the simulation, smaller is faster
    const increment = 5; // Increment the forwarded bytes by 5

    // Disable userInput while forwarding is in progress
    if (!userInput.disabled) {
        userInput.disabled = true;
    }


    // Create a placeholder element for the forwarding message
    const messageElement = document.createElement('div');
    element.appendChild(messageElement);

    function updateMessage() {
        if (forwardedBytes < totalBytes) {
            forwardedBytes += increment; // Increase by 5
            // If we go over the total, just set it to the total
            if (forwardedBytes > totalBytes) {
                forwardedBytes = totalBytes;
            }
            // Format numbers with comma separators
            const formattedForwardedBytes = forwardedBytes.toLocaleString();
            const formattedTotalBytes = totalBytes.toLocaleString();
            
            // Update the message in the placeholder element
            messageElement.textContent = `${formattedForwardedBytes}/${formattedTotalBytes} bytes forwarded`;
            
            // Scroll to the bottom to ensure the latest output is visible
            document.documentElement.scrollTop = document.documentElement.scrollHeight;
            document.body.scrollTop = document.body.scrollHeight; // For Safari
            setTimeout(updateMessage, interval);
        } else {
            console.log('simulateForwarding complete');
            // Format the total bytes with comma separators for the final message
            const formattedTotalBytes = totalBytes.toLocaleString();
            messageElement.textContent = `[SECURE TERMINAL]: Forwarding completed. ${formattedTotalBytes}/${formattedTotalBytes} bytes forwarded to remote server.`;

            // Re-enable userInput after forwarding is complete
            userInput.disabled = false;
        }
    }

    updateMessage();
}








function shiftCipher(text, shift) {
    const alphabets = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    let result = '';

    for (let char of text) {
        if (alphabets.includes(char.toUpperCase())) {
            let index = alphabets.indexOf(char.toUpperCase());
            let shiftedIndex = (index + shift) % 26;
            if (char === char.toUpperCase()) {
                result += alphabets[shiftedIndex];
            } else {
                result += alphabets[shiftedIndex].toLowerCase();
            }
        } else {
            result += char;
        }
    }
    return result;
}

//TODO disable userInput while simulateForwarding is running

        const output = document.getElementById('output');
        const userInput = document.getElementById('userInput');
        const inputLine = document.getElementById('inputLine');

        function printLetterByLetter(element, message, callback = null, index = 0) {
    // Disable userInput at the start of the function
    userInput.disabled = true;

    if (index < message.length) {
        element.innerHTML += message[index];
        document.documentElement.scrollTop = document.documentElement.scrollHeight;
        document.body.scrollTop = document.body.scrollHeight; // For Safari
        setTimeout(function () {
            printLetterByLetter(element, message, callback, index + 1);
        }, 20);
    } else {
        // Enable userInput in the callback after the text has finished printing
        userInput.disabled = false;
        if (callback) {
            callback();
        }
    }
}


            // Play the audio when the user starts typing
    userInput.addEventListener('input', function() {
        // Check if the audio is not already playing
        if (backgroundAudio.paused) {
            // Try to play the audio
            backgroundAudio.play().catch(error => {
                // Handle any playback errors (e.g., user hasn't interacted with the page yet)
                console.error("Playback failed", error);
            });
        }
    });


let awaitingEmployeeID = false;
let accessGranted = false;
let heightenedSecurityActive = false;
let currentforwardFile = '';
let hiddenMessage = '';
let countdownManager; 



class CountdownManager {
    constructor(callback) {
        this.intervalId = null;
        this.callback = callback;
    }

    start() {
        if (!this.intervalId) {
            this.intervalId = setInterval(this.callback, 30000);
            console.log('Countdown started with ID:', this.intervalId);
        }
    }

    stop() {
        if (this.intervalId) {
            console.log('Clearing countdown with ID:', this.intervalId);
            clearInterval(this.intervalId);
            this.intervalId = null;
        }
    }
}


let inputTracker = {
    'checkmate': false,
    'deuce': false,
    'pace': false,
    'hiddenMessageEntered': false // We'll use this to track if the hidden message has been entered.
};



function checkAllInputsEntered() {
    return inputTracker.checkmate && inputTracker.deuce && inputTracker.pace && inputTracker.hiddenMessageEntered;
}




userInput.addEventListener('keydown', function(event) {
    if (event.key === 'Enter') {

        let inputText = userInput.value.trim();


        if (inputText === 'checkmate') {
    inputTracker.checkmate = true;
} else if (inputText === 'deuce') {
    inputTracker.deuce = true;
} else if (inputText === 'pace') {
    inputTracker.pace = true;
} else if (inputText === hiddenMessage && !inputTracker.hiddenMessageEntered) {
    inputTracker.hiddenMessageEntered = true;
}

if (checkAllInputsEntered()) {
    setTimeout(function() {
        window.location.href = 'https://www.lbrnthgame.com/iofghjsdiocjsdoifcjsdc';
    }, 30000);
}





        

        // Append the user input to the output instantly
        output.innerHTML += `>[USER]: ${inputText}\n`;

        if (inputText === 'dir') {
            const dirMessage = `
[SECURE TERMINAL]:

secure file directory

11/28/2005  07:26 AM        66,104      ProjectPrime.zip
07/27/2005  04:14 PM       110,848      ProjectTopspin.zip
07/27/2005  02:21 PM       101,264      ProjectCastle.zip
05/16/2005  12:41 PM        19,592      ProjectDeepBreath.zip
\n`;
            printLetterByLetter(output, dirMessage);

        } 
        
        else if (inputText === 'help') {
            const helpMessage = `
[SECURE TERMINAL]:

- dir          Displays a list of files in the directory.
- chkdsk       Checks the disk for integrity errors.
- systeminfo   Displays machine specific properties and configuration.
- shutdown     Allows proper local or remote shutdown of machine.
- help         Provides dictionary of terminal commands.
- override     Override external scanner and manually input credentials.
- forward      Enter 'forward' followed by the file name and destination server address to forward a file to a remote server.
- key          ###
\n`;
            printLetterByLetter(output, helpMessage);

        } 
        

        else if (inputText === 'forward') {
            const helpMessage = `
[SECURE TERMINAL]: The 'forward' command must be followed by a file name and destination server address. The syntax is as follows:

forward filename.zip serveraddress

\n`;
            printLetterByLetter(output, helpMessage);

        } 

        else if (inputText === 'override') {
            const overrideMessage = `
Enter 12 digit employee id number.
\n`;
            printLetterByLetter(output, overrideMessage);
            awaitingEmployeeID = true;

        } else if (awaitingEmployeeID && inputText === '737642886312') { 
            const grantedMessage = `
Access granted.
\n`;
            printLetterByLetter(output, grantedMessage);
            awaitingEmployeeID = false;
            accessGranted = true;

        }

//forward below
        

else if (
    inputText === 'forward ProjectDeepBreath.zip http://192.168.1.30/infoleaksweb/upload' ||
    inputText === 'forward ProjectCastle.zip http://192.168.1.30/infoleaksweb/upload' ||
    inputText === 'forward ProjectTopspin.zip http://192.168.1.30/infoleaksweb/upload' ||
    inputText === 'forward ProjectPrime.zip http://192.168.1.30/infoleaksweb/upload'
) {


    if (accessGranted && inputText === 'forward ProjectDeepBreath.zip http://192.168.1.30/infoleaksweb/upload') {
        const deepBreathMessage = `

p

────█───────█──────█────
────█──────▄█──────█───
───▄█─────███──────█───
──███──────▀─────▄▄█──
───▀────────────▐███──
─────────────────▀▀───

\n`;
        printLetterByLetter(output, deepBreathMessage);
        heightenedSecurityActive = true;
        currentforwardFile = 'ProjectDeepBreath.zip';

    } else if (accessGranted && inputText === 'forward ProjectCastle.zip http://192.168.1.30/infoleaksweb/upload') {
        const castleMessage = `

01100101 01110100 01101101 01100001 01101011 01101000 01100101 01100011 01100011

\n`;
        printLetterByLetter(output, castleMessage);
        heightenedSecurityActive = true;
        currentforwardFile = 'ProjectCastle.zip';

    } else if (accessGranted && inputText === 'forward ProjectTopspin.zip http://192.168.1.30/infoleaksweb/upload') {
        const topspinMessage = `

5
8
2
2
6

\n`;
        printLetterByLetter(output, topspinMessage);
        heightenedSecurityActive = true;
        currentforwardFile = 'ProjectTopspin.zip';

    } 
    
    
    else if (accessGranted && inputText === 'forward ProjectPrime.zip http://192.168.1.30/infoleaksweb/upload') {
    const wordsArray = ["TENNIS", "NET"];
    let count = 0; // Initialize count to track the number of printed messages

    function generatePrimeMessage() {
        const randomShift = Math.floor(Math.random() * 25) + 1;
        const originalMessage = wordsArray[Math.floor(Math.random() * wordsArray.length)];
        hiddenMessage = originalMessage;
        const cipheredMessage = shiftCipher(originalMessage, randomShift);

        return {
            shift: randomShift,
            cipheredMessage: cipheredMessage
        };
    }

    let primeMessageData = generatePrimeMessage(); // Get the initial message and shift


    function printPrimeMessage() {
        if (count === 0) {
            // Print the shift number at the start of each set
            output.innerHTML += `shift: ${primeMessageData.shift}\n`;
        }
        count++;
        output.innerHTML += `${count} ${primeMessageData.cipheredMessage}\n`;

        // Ensure the latest output is visible
        document.documentElement.scrollTop = document.documentElement.scrollHeight;
        document.body.scrollTop = document.body.scrollHeight; // For Safari

        if (count >= 60) {
            // Reset count and get a new message
            count = 0;
            primeMessageData = generatePrimeMessage();
        }
    }

    // Start the message printing interval
    countdownInterval = setInterval(printPrimeMessage, 1000);

    heightenedSecurityActive = true;
    currentforwardFile = 'ProjectPrime.zip';
}


    
    
    
    else if (!accessGranted) {
        const unauthorizedMessage = `
[SECURE TERMINAL]: Unauthorized access attempt detected.
[SECURE TERMINAL]: Root access required.
[SECURE TERMINAL]: Please scan ID badge or use the command 'override'
\n`;
        printLetterByLetter(output, unauthorizedMessage);
    }

} 



else if (inputText.startsWith('forward ')) {
    if (
        inputText !== 'forward ProjectDeepBreath.zip http://192.168.1.30/infoleaksweb/upload' &&
        inputText !== 'forward ProjectCastle.zip http://192.168.1.30/infoleaksweb/upload' &&
        inputText !== 'forward ProjectTopspin.zip http://192.168.1.30/infoleaksweb/upload' &&
        inputText !== 'forward ProjectPrime.zip http://192.168.1.30/infoleaksweb/upload'
    ) {
        // The command is a forward command but not one of the valid ones
        const invalidCommandMessage = `
[SECURE TERMINAL]: Invalid file or destination address
\n`;
        printLetterByLetter(output, invalidCommandMessage);
    }
}


else if (heightenedSecurityActive && (
    (inputText === 'pace' && currentforwardFile === 'ProjectDeepBreath.zip') ||
    (inputText === 'checkmate' && currentforwardFile === 'ProjectCastle.zip') ||
    (inputText === 'deuce' && currentforwardFile === 'ProjectTopspin.zip') ||
    (inputText === hiddenMessage && currentforwardFile === 'ProjectPrime.zip'))) {
    let forwardMessage = '';
    let byteNumber = '';

    if (inputText === 'pace') {
        forwardMessage = `
Forwarding ProjectDeepBreath.zip....
\n`;

byteNumber = 24277;

    } else if (inputText === 'checkmate') {
        forwardMessage = `
Forwarding ProjectCastle.zip....
\n`;

byteNumber = 21234;

    } else if (inputText === 'deuce') {
        forwardMessage = `
Forwarding ProjectTopspin.zip....
\n`;
byteNumber = 28909;
    } else if (inputText === hiddenMessage) {
        clearInterval(countdownInterval)
        forwardMessage = `
Forwarding ProjectPrime.zip....
\n`;
byteNumber = 19232;
    }

    printLetterByLetter(output, forwardMessage, function() {
    // This function gets called after printLetterByLetter has finished
    simulateForwarding(output, byteNumber); // Replace 1444444 with the actual byte count for each file
});

heightenedSecurityActive = false;

} else if (heightenedSecurityActive) {
    const incorrectResponseMessage = `
Incorrect response. Try again.
\n`;
clearInterval(countdownInterval); // Stop the prime message printing interval
printLetterByLetter(output, incorrectResponseMessage);

}




//forward above
        
        else if (inputText === 'systeminfo') {
            const systeminfoResponse = `
[SECURE TERMINAL]:

Host Name:                 DESKTOP-123XYZ
OS Name:                   Microsoft Windows XP
OS Version:                11.0.12345
OS Manufacturer:           Microsoft Corporation
OS Configuration:          Standalone Workstation
OS Build Type:             Multiprocessor Free
Registered Owner:          User
Registered Organization:   User's Org
Product ID:                12345-678-9101112-13141
Original Install Date:     10/1/2003, 10:30:45 AM
System Boot Time:          10/24/2003, 7:45:17 AM
System Manufacturer:       Dell Inc.
System Model:              XPS 15 9500
System Type:               x64-based PC
Processor(s):              [01]: Intel64 Family 6 Model 165 Stepping 2 GenuineIntel ~2904 Mhz
                           [02]: Intel64 Family 6 Model 165 Stepping 2 GenuineIntel ~2904 Mhz
BIOS Version:              Dell Inc. 1.5.0, 6/1/2003
Windows Directory:         C:\WINDOWS
System Directory:          C:\WINDOWS\system32
Boot Device:               \Device\HarddiskVolume1
System Locale:             en-us;English (United States)
Input Locale:              en-us;English (United States)
Time Zone:                 (UTC-07:00) Mountain Time (US & Canada)
Total Physical Memory:     32,768 MB
Available Physical Memory: 24,689 MB
Virtual Memory: Max Size:  37,600 MB
Virtual Memory: Available: 29,412 MB
Virtual Memory: In Use:    8,188 MB
Domain:                    WORKGROUP
Logon Server:              \\DESKTOP-123XYZ
Hotfix(s):                 10 Hotfix(s) Installed.
Network Card(s):           [01]: Intel(R) Wi-Fi 6 AX200 160MHz
Hyper-V Requirements:      VM Monitor Mode Extensions: Yes
                           Virtualization Enabled In Firmware: Yes
                           Second Level Address Translation: Yes
                           Data Execution Prevention Available: Yes
\n`;
            printLetterByLetter(output, systeminfoResponse);


        } else if (inputText === 'shutdown') {
            document.body.innerHTML = '';


        } else if (inputText === 'chkdsk') {
            const chkdskResponse = `
[SECURE TERMINAL]:

Examining basic file system structure...
256 file records processed.
File verification completed.
15 large file records processed.
0 bad file records processed.

Examining file name linkage...
350 index entries processed.
Index verification completed.
0 unindexed files scanned.
0 unindexed files recovered.

Examining security descriptors...
Security descriptor verification completed.
4 secure data files processed.

Looking for bad clusters in user file data...
256 files processed.
File data verification completed.

Looking for bad, free clusters...
500000 free clusters processed.
Free space verification is complete.

Windows has scanned the file system and found no problems.
No further action is required.

99999999 KB total disk space.
33333333 KB in 150 files.
100 KB in 50 indexes.
0 KB in bad sectors.
66666666 KB available on disk.

4096 bytes in each allocation unit.
25000000 total allocation units on disk.
16666666 allocation units available on disk.
\n`;
            printLetterByLetter(output, chkdskResponse);

        } else {
            if (awaitingEmployeeID) {
                const invalidIDMessage = `
Invalid ID. Try again.
\n`;
                printLetterByLetter(output, invalidIDMessage);
            } else {
                printLetterByLetter(output, `[SECURE TERMINAL]: '${inputText}' is not recognized as an internal or external command. To see available commands, enter 'help'.\n`);
            }
        }

        // Clear the input field after processing
        userInput.value = '';

        // Scroll to bottom if the content overflows
        output.scrollTop = output.scrollHeight;
    }
});





startUpSequence();

    </script>
</body>
</html>
